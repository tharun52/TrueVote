2025-06-09 15:29:17.418 +05:30 [INF] User profile is available. Using '/Users/tharun52/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-06-09 15:29:17.474 +05:30 [INF] Now listening on: http://localhost:5100
2025-06-09 15:29:17.475 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-09 15:29:17.475 +05:30 [INF] Hosting environment: Development
2025-06-09 15:29:17.475 +05:30 [INF] Content root path: /Users/tharun52/Documents/programming/TrueVote/TrueVote
2025-06-09 15:29:31.842 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - application/json 77
2025-06-09 15:29:31.920 +05:30 [INF] Executing endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:29:31.928 +05:30 [INF] Route matched with {action = "AddModerator", controller = "Moderator"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddModeratorAsync(TrueVote.Models.DTOs.AddModeratorRequestDto) on controller TrueVote.Controllers.ModeratorController (TrueVote).
2025-06-09 15:29:32.689 +05:30 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Moderators" ("Id", "Email", "IsDeleted", "Name")
VALUES (@p0, @p1, @p2, @p3);
2025-06-09 15:29:32.709 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Username", "HashKey", "PasswordHash", "Role", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-09 15:29:32.716 +05:30 [INF] Executing CreatedResult, writing value of type 'TrueVote.Models.DTOs.ApiResponse`1[[TrueVote.Models.Moderator, TrueVote, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-09 15:29:32.731 +05:30 [INF] Executed action TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote) in 801.8924ms
2025-06-09 15:29:32.733 +05:30 [INF] Executed endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:29:32.737 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - 201 null application/json; charset=utf-8 896.7655ms
2025-06-09 15:31:55.079 +05:30 [INF] Application is shutting down...
2025-06-09 15:32:00.133 +05:30 [INF] User profile is available. Using '/Users/tharun52/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-06-09 15:32:00.238 +05:30 [INF] Now listening on: http://localhost:5100
2025-06-09 15:32:00.239 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-09 15:32:00.239 +05:30 [INF] Hosting environment: Development
2025-06-09 15:32:00.239 +05:30 [INF] Content root path: /Users/tharun52/Documents/programming/TrueVote/TrueVote
2025-06-09 15:32:25.240 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - application/json 77
2025-06-09 15:32:25.326 +05:30 [INF] Executing endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:32:25.333 +05:30 [INF] Route matched with {action = "AddModerator", controller = "Moderator"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddModeratorAsync(TrueVote.Models.DTOs.AddModeratorRequestDto) on controller TrueVote.Controllers.ModeratorController (TrueVote).
2025-06-09 15:32:26.121 +05:30 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Boolean), @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Moderators" ("Id", "Email", "IsDeleted", "Name")
VALUES (@p0, @p1, @p2, @p3);
2025-06-09 15:32:26.141 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Username", "HashKey", "PasswordHash", "Role", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-09 15:32:26.148 +05:30 [INF] Executing CreatedResult, writing value of type 'TrueVote.Models.DTOs.ApiResponse`1[[TrueVote.Models.Moderator, TrueVote, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-09 15:32:26.162 +05:30 [INF] Executed action TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote) in 826.7067ms
2025-06-09 15:32:26.164 +05:30 [INF] Executed endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:32:26.168 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - 201 null application/json; charset=utf-8 929.2941ms
2025-06-09 15:32:43.430 +05:30 [INF] Application is shutting down...
2025-06-09 15:39:44.617 +05:30 [INF] User profile is available. Using '/Users/tharun52/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-06-09 15:39:44.681 +05:30 [INF] Now listening on: http://localhost:5100
2025-06-09 15:39:44.682 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-06-09 15:39:44.682 +05:30 [INF] Hosting environment: Development
2025-06-09 15:39:44.682 +05:30 [INF] Content root path: /Users/tharun52/Documents/programming/TrueVote/TrueVote
2025-06-09 15:39:48.682 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - application/json 77
2025-06-09 15:39:48.745 +05:30 [INF] Executing endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:39:48.752 +05:30 [INF] Route matched with {action = "AddModerator", controller = "Moderator"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddModeratorAsync(TrueVote.Models.DTOs.AddModeratorRequestDto) on controller TrueVote.Controllers.ModeratorController (TrueVote).
2025-06-09 15:39:49.509 +05:30 [INF] Executed action TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote) in 755.4174ms
2025-06-09 15:39:49.515 +05:30 [INF] Executed endpoint 'TrueVote.Controllers.ModeratorController.AddModeratorAsync (TrueVote)'
2025-06-09 15:39:49.517 +05:30 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: User with this email already exists
   at TrueVote.Service.ModeratorService.AddModerator(AddModeratorRequestDto moderatorDto) in /Users/tharun52/Documents/programming/TrueVote/TrueVote/Service/ModeratorService.cs:line 58
   at TrueVote.Controllers.ModeratorController.AddModeratorAsync(AddModeratorRequestDto moderatorDto) in /Users/tharun52/Documents/programming/TrueVote/TrueVote/Controllers/ModeratorController.cs:line 57
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-09 15:39:49.532 +05:30 [ERR] Connection id "0HND77N26MMQB", Request id "0HND77N26MMQB:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: Can't close, connection is in state Connecting
   at Npgsql.NpgsqlConnection.Close(Boolean async)
   at Npgsql.NpgsqlConnection.CloseAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.CloseDbConnectionAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ResetStateAsync(Boolean disposeDbConnection)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.EntityFrameworkCore.DbContext.DisposeAsync()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.<FireOnCompleted>g__ProcessEvents|242_0(HttpProtocol protocol, Stack`1 events)
2025-06-09 15:39:49.536 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5100/api/v1/Moderator - 500 null text/plain; charset=utf-8 854.8448ms
2025-06-09 15:39:49.607 +05:30 [INF] Executed DbCommand (35ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Username", u."HashKey", u."PasswordHash", u."Role", u."UserId"
FROM "Users" AS u
WHERE u."Username" = @__key_0
LIMIT 2
2025-06-09 15:39:49.612 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'TrueVote.Contexts.AppDbContext'.
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'AppDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Internal.IDbContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContext.InitializeStateManager(Boolean standAlone)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'AppDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Internal.IDbContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContext.InitializeStateManager(Boolean standAlone)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-09 15:39:52.843 +05:30 [INF] Application is shutting down...
2025-06-09 15:56:22.252 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-06-09 15:56:22.410 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-06-09 15:56:22.414 +05:30 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-06-09 15:56:22.416 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-06-09 15:56:22.416 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-06-09 15:56:22.420 +05:30 [INF] Applying migration '20250609102612_rename_pollFile'.
2025-06-09 15:56:22.425 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250609102612_rename_pollFile', '9.0.5');
